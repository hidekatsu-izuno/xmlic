<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>XMLIC - jQuery like DOM traversal and manipulation API</title>
<link rel="stylesheet" href="css/common.css" />
<style>
.sourceforge { position: absolute; top: 5px; right: 10px; }
</style>
</head>
<body>
<div class="nav">
<h1 class="logo"><a href="#"><img src="img/xmlic.jpg" alt="XMLIC" width="115" height="34" /></a></h1>
<div class="bar">version 0.8.0</div>
<ul class="menu">
	<li><a href="#introduction">XMLICとは</a></li>
	<li><a href="#download">ダウンロード</a></li>
	<li><a href="#usage">基本的な使い方</a></li>
	<li><a href="#load">XML文書の読み込み</a></li>
	<li><a href="#traversal">DOMの検索</a>
		<ul>
			<li><a href="#find">要素の検索</a></li>
			<li><a href="#select">ノードの検索</a></li>
			<li><a href="#xpath">XPathとCSSセレクタとの比較</a></li>
			<li><a href="#children">子要素の取得</a></li>
			<li><a href="#parent">親要素の取得</a></li>
			<li><a href="#sibling">兄弟要素の取得</a></li>
			<li><a href="#contents">子ノードの取得</a></li>
			<li><a href="#filter">取得結果の操作</a></li>
		</ul>
	</li>
	<li><a href="#manipulation">DOMの操作</a>
		<ul>
			<li><a href="#element">要素の操作</a></li>
			<li><a href="#attr">属性の操作</a></li>
			<li><a href="#normalize">ノードの正規化</a></li>
		</ul>
	</li>
	<li><a href="#evaluation">DOMの評価</a>
		<ul>
			<li><a href="#is">要素の評価</a></li>
			<li><a href="#evaluate">ノードの評価</a></li>
		</ul>
	</li>
	<li><a href="#writeto">XML文書の出力</a></li>
	<li>API リファレンス
		<ul>
			<li><a href="http://xmlic.sourceforge.jp/api/index.html">javadoc</a></li>
		</ul>
	</li>
	<li><a href="#license">ライセンス</a></li>
	<li><a href="#report">バグ・要望の報告先</a></li>
	<li><a href="#releasenote">リリースノート</a></li>
</ul>
</div>
<div class="header">
<h1><span class="title">XMLIC</span> <span class="sub">- jQuery like DOM traversal and manipulation API</span></h1>
<div class="sourceforge"><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=8657&type=1" width="96" height="31" border="0" alt="SourceForge.JP"></a></div>
<div class="bar">&nbsp;</div>
</div>
<div class="main">

<h2 id="introduction" style="margin-top: 0px;">XMLIC（ズムリック）とは</h2>
<p>jQuery ライクな DOM 操作を実現する Java 用 XML APIです。JDOM や XOM などと異なり、あくまで W3C 標準の DOM に対し検索、操作を行なうため、XSLT など他ライブラリとの高い相互運用性を実現出来ます。<br />
API の使い方は jQuery に似ていますが、XMLIC は XML の操作に特化しているため、次のような違いがあります。</p>
<ul>
<li>CSS セレクタの代わりに XPath を使用します。</li>
<li>複数ドキュメントを扱うことができます。入出力機能も用意されています。</li>
<li>XML名前空間を適切に扱うことができます。</li>
</ul>
<p>使い方は簡単です。jQuery 利用者ならば、すぐに使いはじめることができるでしょう。</p>
<pre class="source">
import net.arnx.xmlic.XML;

<span class="comment">// test.xml を読み込んで div タグに class="alert" という属性を設定します。</span>
XML.load(new File("test.xml"))
    .find("//div")
    .attr("class", "alert");
</pre>

<h2 id="download">ダウンロード</h2>
<p><a href="http://sourceforge.jp/projects/xmlic">ダウンロードはこちらから</a>可能です。なお、XMLICのビルド/実行には、Java SE 6 以上が必要です。</p>
<script src="http://sourceforge.jp/projects/xmlic/releases/compact.js" type="text/javascript" charset="utf-8"></script>

<h2 id="usage">基本的な使い方</h2>
<p>jQuery の Traversal/Manipulation API をそのままの仕様で移植していますので同じように操作が可能です。大きく違う点は、<code>Document</code> の取り回しです。
jQuery が単一の <code>window.document</code> に対して　XMLIC は複数のドキュメントを扱う必要があります。このような処理のために<code>XML</code> クラスが用意されています（jQuery の <code>$</code> 関数に当たるものだと考えるとわかりやすいでしょう）。</p>
<ul>
<li>読み込みには、 <code>XML</code> クラスの <code>load()</code> スタティックメソッドを使います。</li>
<li>読み込んだ  <code>XML</code> インスタンスに対し、<code>find()</code> メソッドで <code>Nodes</code> インスタンスを取得し操作します（<code>Nodes</code> インスタンスは <code>jQuery</code> オブジェクトに当たるものだと考えるとよいでしょう）。</li>
<li><code>Nodes</code> インスタンスからは <code>getOwner()</code> メソッドを通じて <code>XML</code> インスタンスにいつでもアクセスできます。</li>
<li>書き込みは、 <code>XML</code> インスタンスの <code>writeTo()</code> メソッドを使います。</li>
</ul>
<p>なお、XPath は jQuery セレクタより機能が豊富ですが違いも大きいので注意が必要です。例えば <code>find("div")</code> と記述した場合、
jQuery では子孫ノードすべてが対象になりますが、XPath で同じ動作を実現するには <code>find("//div")</code> と記述する必要があります。</p>

<h2 id="load">XML 文書の読み込み <span class="sub">- Load</span></h2>

<p>XML 文書の読み込みには、２パターンが用意されています。通常は <code>XML</code> クラスの <code>load</code> スタティックメソッドを使います。オプションは指定出来ませんが、通常の利用では困ることはないでしょう。</p>
<pre class="source">
<span class="comment">// ファイルから <code>XML</code> クラスのインスタンスを取得します。</span>
XML xml = XML.load(new File("test.xml"));

<span class="comment">// <code>InputStrem</code> から <code>XML</code> クラスのインスタンスを取得します。</span>
XML xml = XML.load(new FileInputStream("test.xml"));

<span class="comment">// <code>Reader</code> から <code>XML</code> クラスのインスタンスを取得します。</span>
XML xml = XML.load(new FileReader("test.xml"));
</pre>

<p>検証を行なう必要があるなど、オプションの指定が必要な場合は、<code>XMLLoader</code> を使います。</p>

<h2 id="traversal">DOM の検索 <span class="sub">- Traversal</span></h2>

<h3 id="find">要素の検索</h3>
<p>要素の検索には  <code>find</code> メソッドを使います。<code>find</code> メソッドは、<code>XML</code> クラス、<code>Nodes</code> クラスの両方で利用できます。引数には、XPath 式を記述します。CSS セレクタとは異なり、<code>//</code> から始めないと子要素のみの検索になることに注意してください。</p>
<pre class="source">
<span class="comment">// ドキュメントから div 要素を探し、さらに href 属性をもつ a 子要素を検索します。</span>
xml.find("//div").find("a[@href]");
</pre>
<p>ネームペースに対して検索する場合は、プレフィックスを付与します。
プレフィックスは、原則としてロード時に指定したものを使用します（未指定の場合は、ドキュメントからネームペースを取得しますが、読み込んだ XML に依存してしまいますので、お勧めできません）。</p>
<pre class="source">
<span class="comment">// ネームスペースを指定して XML インスタンスを構築します。</span>
Map&lt;String, String&gt; namespaces = new HashMap&lt;String, String&gt;();
namespaces.put("h", "http://www.w3.org/1999/xhtml")
XML xml = XML.load(new File("test.xml"), namespaces);

<span class="comment">// ドキュメントから xhtml の div 要素を探し、さらに href 属性をもつ xhtml の a 子要素を検索します。</span>
<span class="comment">// 指定するプレフィックスは、ドキュメント内に実際に付与されたプレフィックスには依存しません。</span>
xml.find("//h:div").find("h:a[@href]");
</pre>

<h3 id="select">ノードの検索</h3>
<p>XPath は、要素以外にもテキストノードや属性ノード、コメントノードなども対象にすることができます。
XMLIC では、それに対応して jQuery にはない <code>select</code> メソッドを追加しています。引数には、XPath 式を記述します。属性値の設定／取得には <code>val</code> メソッドを使います。</p>
<pre class="source">
<span class="comment">// ドキュメントから最初の属性ノードを検索し、その値を取得します。</span>
xml.select("//attribute::node()[1]").val();
</pre>

<h3 id="xpath">XPath と CSS セレクタとの比較</h3>
<p>主要な XPath 式と CSS セレクタの対比表を次に示します。参考にしてください。</p>
<table class="table">
<colgroup>
<col style="width: 150px" />
<col style="width: 200px" />
<col style="width: 200px" />
<col />
</colgroup>
<thead>
<tr><th>対象</th><th>XPath</th><th>CSS セレクタ</th><th>備考</th></tr>
</thead>
<tbody>
<tr><td>すべての要素</td><td><code>//*</code></td><td><code>*</code></td><td></td></tr>
<tr><td>要素が一致</td><td><code>//element</code></td><td><code>element</code></td><td></td></tr>
<tr><td>子要素</td><td><code>//parent/child</code></td><td><code>parent &gt; child</code></td><td></td></tr>
<tr><td>子孫要素</td><td><code>//ancestor//descendant</code></td><td><code>ancestor descendant</code></td><td></td></tr>
<tr><td>属性がある</td><td><code>//*[@name]</code></td><td><code>[name]</code></td><td></td></tr>
<tr><td>属性が一致</td><td><code>//*[@name='value']</code></td><td><code>[name='value']</code></td><td></td></tr>
<tr><td>n番目の子要素</td><td><code>//*[n]</code></td><td><code>:nth-child(n)</code></td><td></td></tr>
<tr><td>最初の子要素</td><td><code>//*[first()]</code></td><td><code>:first-child</code></td><td></td></tr>
<tr><td>最後の子要素</td><td><code>//*[last()]</code></td><td><code>:last-child</code></td><td></td></tr>
<tr><td>OR 条件選択</td><td><code>expr | ... | expr</code></td><td><code>expr, ..., expr</code></td><td></td></tr>
</tbody>
</table>
<p>jQueryでは <code>#ID</code> の形でID指定を多用しますが、XMLではスキーマにID型が指定されない限り利用できないため、通常の属性同様 <code>//*[@id='ID']</code> と記述します。</p>

<h2 id="#manipulation">DOM の操作  <span class="sub">- Manipulation</span></h2>

<h2 id="writeto">XML 文書の出力 <span class="sub">- Write</span></h2>


<h2 id="license">ライセンス</h2>
<p>XMLIC は、<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>下で配布します。</p>
<p><b>自分のライブラリへの組み込んでいただいたり、その際にパッケージ名の変更や処理の変更など行っていただいても何ら構いません。</b>ライセンスの範囲内でご自由にお使いください。</p>

<h2 id="report">バグ・要望の報告先</h2>
<p>バグや要望などは<a href="http://sourceforge.jp/projects/xmlic">XMLIC プロジェクトサイト</a>の<a href="http://sourceforge.jp/projects/xmlic/ticket/">チケット</a>に報告ください。</p>

<h2 id="releasenote">リリースノート</h2>

<h3>2013/7/16 version 0.8.0</h3>
<ul>
<li>XMLIC 最初のリリースとなります。元となる仕様が jQuery API ですので大きな変更は予定していませんが、1.0 までは不具合、要望など積極的に取り入れたいと思いますので、ご要望あれば是非。</li>
</ul>

</div>

<div class="footer">
Copyright (C) 2013 Hidekatsu Izuno All right reserved.
</div>
</body>
</html>